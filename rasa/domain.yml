version: "3.1"

intents:
  - saludo
  - despedida

  - preguntar_fotomulta
  - plazo_fotomulta
  - descuentos_fotomulta
  - impugnar_fotomulta
  - costos_fotomulta

  # Intents futuros
  - consultar_notificacion
  - consultar_propietario_conductor
  - consultar_suspension_licencia
  - consultar_estado_fotomulta
  - consultar_proceso_cobro
  - consultar_curso_pedagogico
  - consultar_validez_fotomulta
  - consultar_tiempos_proceso
  - consultar_prescripcion
  - consultar_documentos_requeridos
  - consultar_compra_venta
  - consultar_inmovilizacion

  # Intent para reporte de incidente con form
  - reportar_incidente

entities:
  - placa
  - cedula
  - nombre
  - email
  - lugar_hechos
  - tipo_vehiculo

slots:
  placa:
    type: text
    mappings:
      - type: from_entity
        entity: placa

  cedula:
    type: text
    mappings:
      - type: from_entity
        entity: cedula

  tiene_multas:
    type: bool
    mappings:
      - type: custom

  monto_total:
    type: float
    mappings:
      - type: custom

  nombre:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: nombre
      - type: from_text
        conditions:
          - active_loop: reportar_incidente_form
            requested_slot: nombre

  email:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: email
      - type: from_text
        conditions:
          - active_loop: reportar_incidente_form
            requested_slot: email

  lugar_hechos:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: lugar_hechos
      - type: from_text
        conditions:
          - active_loop: reportar_incidente_form
            requested_slot: lugar_hechos

  tipo_vehiculo:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: tipo_vehiculo
      - type: from_text
        conditions:
          - active_loop: reportar_incidente_form
            requested_slot: tipo_vehiculo

actions:
  - action_default_fallback
  - action_consultar_con_openrouter

forms:
  reportar_incidente_form:
    required_slots:
      - nombre
      - email
      - lugar_hechos
      - tipo_vehiculo

session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: true
